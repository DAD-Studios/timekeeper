<div class="page-header">
  <h1>Projects</h1>
  <div class="actions">
    <%= link_to "New Project", new_project_path, class: "btn" %>
  </div>
</div>

<% @grouped_projects.each do |client, projects| %>
  <div class="mb-3" data-controller="collapsible">
    <!-- Client Header (Collapsible) -->
    <div class="client-header"
         style="background: #5cb85c; color: white; padding: 1rem 1.5rem; border-radius: 6px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; margin-bottom: 0;"
         data-action="click->collapsible#toggle">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <i class="bi bi-chevron-down" data-collapsible-target="icon"></i>
        <strong style="font-size: 16px;"><%= client.name %></strong>
      </div>
      <div style="display: flex; gap: 2rem; font-size: 14px;">
        <span><i class="bi bi-folder"></i> <%= projects.count %> <%= projects.count == 1 ? 'project' : 'projects' %></span>
      </div>
    </div>

    <!-- Projects Table -->
    <div data-collapsible-target="content">
      <table style="margin-bottom: 0; border-radius: 0; border-top: none;">
        <thead style="position: sticky; top: 0; z-index: 10;">
          <tr>
            <th><%= sortable "name" %></th>
            <th><%= sortable "rate" %></th>
            <th colspan="2"></th>
          </tr>
        </thead>
        <tbody>
          <% projects.each do |project| %>
            <tr>
              <td data-label="Name"><%= link_to project.name, project %></td>
              <td data-label="Rate"><%= number_to_currency(project.rate) %></td>
              <td data-label="Actions">
                <%= link_to project, title: "View Project" do %><i class="bi bi-eye"></i><% end %>
                <%= link_to edit_project_path(project), title: "Edit Project" do %><i class="bi bi-pencil"></i><% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>
